from celery import Celery
from <%=handler_name%> import <%=handler_class%>
import json
import time
app = Celery('tasks', broker='amqp://<%=rabbit_user%>:<%=rabbit_pass%>@<%=rabbit_ip%>/<%=rabbit_vhost%>')
nosql = <%=handler_class%>(['<%=nosql_ip%>'])

@app.task
def read_test(x):
    from celery import current_task
    task_id = current_task.request.id
    print 'read ' + task_id + " " +  json.dumps({"time": time.time()})
    return nosql.get_element_by_timestamp(x)

@app.task
def write_test(x):
    print 'write'
    return nosql.perform_write(x)
