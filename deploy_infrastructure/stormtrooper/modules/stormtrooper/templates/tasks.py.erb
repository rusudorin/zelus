from celery import Celery
from <%=handler_name%> import <%=handler_class%>
from data_gen import generate_str
import json
app = Celery('tasks', broker='amqp://<%=rabbit_user%>:<%=rabbit_pass%>@<%=rabbit_ip%>/<%=rabbit_vhost%>')
nosql = <%=handler_class%>(['<%=nosql_ip%>'])


@app.task
def read_nosql(x):
    return nosql.get_element_by_timestamp(x)


@app.task
def write_nosql(x):
    return nosql.perform_write(generate_str(x))


@app.task
def update_nosql(x, y):
    return nosql.perform_update(x, generate_str(y))


@app.task
def start_consuming(x):
    return True


@app.task
def stop_consuming(x):
    return True